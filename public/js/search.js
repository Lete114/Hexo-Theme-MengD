try{var localSearch=document.getElementById("local-search"),html=document.querySelector("html"),mask=document.getElementById("mask"),searchBtn=document.querySelector(".search-btn"),searchClose=document.querySelector(".search-close-button"),isLoad=!1,searchId="local-search-input",contentId="local-search-result";async function search(e){isLoad=!0;var t=e.split(".")[1];let a=[];const l=await fetch(e);if("json"==t&&(a=await l.json()),"xml"==t){var s=await l.text();const r=new window.DOMParser,n=r.parseFromString(s,"text/xml");a=[...n.querySelectorAll("entry")].map(e=>({title:e.querySelector("title").textContent,content:e.querySelector("content").textContent,url:e.querySelector("url").textContent}))}var s=document.getElementById(searchId),c=document.getElementById(contentId);s.addEventListener("input",function(){var m='<ul class="search-result-list">',d=this.value.trim().toLowerCase().split(/[\s\-]+/);c.innerHTML="",this.value.trim().length<=0||(a.forEach(e=>{var a=!0;e.title&&""!==e.title.trim()||(e.title="Untitled");var l,t,s,c,r=e.title.trim().toLowerCase(),n=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=e.url.startsWith("/")?e.url:"/"+e.url,i=-1,h=-1;""!==n?d.forEach(function(e,t){l=r.indexOf(e),i=n.indexOf(e),l<0&&i<0?a=!1:(i<0&&(i=0),0==t&&(h=i))}):a=!1,a&&(t=e.content.trim().replace(/<[^>]+>/g,""),0<=h&&(s=h+80,(s=0==(e=(e=h-20)<0?0:e)?100:s)>t.length&&(s=t.length),c=t.substring(e,s),d.forEach(e=>{var t=new RegExp(e,"gi");c=c.replace(t,'<span class="search-keyword">'+e+"</span>"),r=r.replace(t,'<span class="search-keyword">'+e+"</span>")}),m+="<li><a href='"+o+"' class='search-result-title'>"+r+"</a>",m+='<p class="search-result">'+c+"...</p>"),m+="</li>")}),m+="</ul>",c.innerHTML=m,window.pjax&&window.pjax.refresh(c))})}searchBtn.onclick=function(){isLoad||search($config.searchFile),mask.className="mask",localSearch.style.display||(localSearch.style.display="block",html.style.overflow="hidden",localSearch.classList.remove("search-animation-min"),localSearch.classList.add("search-animation-max"),document.getElementById(searchId).focus())},searchClose.onclick=function(){localSearch.classList.remove("search-animation-max"),localSearch.classList.add("search-animation-min"),mask.classList.remove("mask"),html.style.overflow="auto",setTimeout(()=>localSearch.style.display="",500)},window.addEventListener("pjax:complete",()=>{"none"===localSearch.style.display&&(mask.className="")})}catch(e){console.log("search error: ",e)}